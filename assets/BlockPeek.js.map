{"version":3,"file":"BlockPeek.js","sources":["../assets-src/BlockPeek.js"],"sourcesContent":["(($) => {\n\tconst DEBOUNCE_DELAY = 50;\n\n\tlet debounceTimer = null;\n\n\tfunction debounce(func, delay) {\n\t\treturn function (...args) {\n\t\t\tclearTimeout(debounceTimer);\n\t\t\tdebounceTimer = setTimeout(() => func.apply(this, args), delay);\n\t\t};\n\t}\n\n\tfunction iframePreviews() {\n\t\tconst $iframes = $(\"iframe[data-iframe-preview]\");\n\t\tconst resizeIframe = (event) => {\n\t\t\t// Only accept messages from your iframeâ€™s origin\n\t\t\tif (event.data?.type === \"resize\" && event.data?.id) {\n\t\t\t\tconst iframe = $iframes.filter(`[data-slice-id=\"${event.data.id}\"]`)[0];\n\t\t\t\tif (!iframe) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst wrapper = iframe.parentElement;\n\t\t\t\tconst zoomFactor = parseFloat(wrapper.dataset.zoomFactor) || 0.5;\n\t\t\t\twrapper.style.height = `${event.data.height * zoomFactor}px`;\n\t\t\t}\n\t\t};\n\n\t\twindow.removeEventListener(\"message\", resizeIframe);\n\t\tif (!$iframes.length) {\n\t\t\treturn;\n\t\t}\n\t\twindow.addEventListener(\"message\", resizeIframe);\n\t}\n\n\tfunction asyncEdit() {\n\t\tif (rex.page !== \"content/edit\") {\n\t\t\treturn;\n\t\t}\n\n\t\tlet setHistory = true;\n\t\tlet existingSliceEdit = $(\".rex-slice-edit\");\n\n\t\tconst handleEdit = () => {\n\t\t\tconst editButtons = $('a.btn-edit[href*=\"slice_id\"]');\n\t\t\teditButtons\n\t\t\t\t.off(\"click.asyncEdit\")\n\t\t\t\t.on(\"click.asyncEdit\", async function (e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst $this = $(this);\n\t\t\t\t\tconst slice = $(this).closest(\".rex-slice\");\n\t\t\t\t\tconst sliceId = slice.attr(\"id\");\n\t\t\t\t\tif (!sliceId) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (existingSliceEdit.length) {\n\t\t\t\t\t\tif (existingSliceEdit && sliceId === existingSliceEdit.attr(\"id\")) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tawait restoreExistingSlice(existingSliceEdit);\n\t\t\t\t\t\texistingSliceEdit = null;\n\t\t\t\t\t}\n\n\t\t\t\t\trestore();\n\t\t\t\t\trex_loader.show();\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst result = await fetch(this.href, {\n\t\t\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\"Content-Type\": \"text/html\",\n\t\t\t\t\t\t\t\t\"X-Requested-With\": \"XMLHttpRequest\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (!result.ok) throw new Error(\"Network response was not ok\");\n\t\t\t\t\t\tconst html = await result.text();\n\t\t\t\t\t\tconst resultSlice = $(html).find(`#${sliceId}`);\n\n\t\t\t\t\t\tif (resultSlice.length) {\n\t\t\t\t\t\t\t$(\".panel-body .alert\").remove();\n\t\t\t\t\t\t\tsetSliceEdit(sliceId, slice);\n\t\t\t\t\t\t\tslice.replaceWith(resultSlice);\n\t\t\t\t\t\t\t$(document).trigger(\"rex:ready\", [resultSlice]);\n\t\t\t\t\t\t\thandleSave(resultSlice);\n\t\t\t\t\t\t\tdebouncedScrollToSlice(resultSlice[0]);\n\t\t\t\t\t\t\tif (setHistory) {\n\t\t\t\t\t\t\t\thistory.pushState(null, \"\", $this.attr(\"href\")); // change url without reloading page\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetHistory = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trex_loader.hide();\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error(\"Error editing slice:\", error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t};\n\n\t\tconst handleSave = (slice) => {\n\t\t\tconst form = slice.find(\"form\");\n\t\t\tconst saveButton = slice.find(\".btn-save\");\n\t\t\tconst applyButton = slice.find(\".btn-apply\");\n\t\t\tif (saveButton.length) {\n\t\t\t\tif (form.length) {\n\t\t\t\t\tform.off(\"submit.asyncSave\").on(\"submit.asyncSave\", (e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tsaveButton.trigger(\"click.asyncSave\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tsaveButton.off(\"click.asyncSave\").on(\"click.asyncSave\", (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst buttonAction = saveButton.attr(\"name\");\n\t\t\t\t\tconst buttonActionValue = saveButton.attr(\"value\");\n\t\t\t\t\tconst formData = new FormData(form[0]);\n\t\t\t\t\tformData.append(buttonAction, buttonActionValue);\n\t\t\t\t\tfetch(form.attr(\"action\"), {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\tbody: formData,\n\t\t\t\t\t})\n\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\t\tthrow new Error(\"Network response was not ok\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn response.text();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((html) => {\n\t\t\t\t\t\t\tconst updatedSlice = $(html).find(`#${slice.attr(\"id\")}`);\n\t\t\t\t\t\t\tif (updatedSlice.length) {\n\t\t\t\t\t\t\t\tslice.replaceWith(updatedSlice);\n\t\t\t\t\t\t\t\tdebouncedScrollToSlice(updatedSlice[0]);\n\t\t\t\t\t\t\t\texistingSliceEdit = [];\n\t\t\t\t\t\t\t\thandleEdit();\n\t\t\t\t\t\t\t\t// update the URL to remove `&function=edit#slice2` after saving\n\t\t\t\t\t\t\t\tif (window.location.search.includes(\"function=edit\")) {\n\t\t\t\t\t\t\t\t\tconst url = new URL(window.location);\n\t\t\t\t\t\t\t\t\turl.searchParams.delete(\"function\");\n\t\t\t\t\t\t\t\t\twindow.history.replaceState(null, \"\", url.toString());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$(document).trigger(\"rex:ready\", [updatedSlice || slice]);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.error(\"Error saving slice:\", error);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (applyButton.length) {\n\t\t\t\tapplyButton.off(\"click.asyncApply\").on(\"click.asyncApply\", (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst buttonAction = applyButton.attr(\"name\");\n\t\t\t\t\tconst buttonActionValue = applyButton.attr(\"value\");\n\t\t\t\t\tconst formData = new FormData(form[0]);\n\t\t\t\t\tformData.append(buttonAction, buttonActionValue);\n\t\t\t\t\t// store current scroll position to restore it after saving\n\t\t\t\t\tconst scrollPosition = window.scrollY;\n\t\t\t\t\tfetch(form.attr(\"action\"), {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\tbody: formData,\n\t\t\t\t\t})\n\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\t\tthrow new Error(\"Network response was not ok\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn response.text();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((html) => {\n\t\t\t\t\t\t\tconst updatedSlice = $(html).find(`#${slice.attr(\"id\")}`);\n\t\t\t\t\t\t\tif (updatedSlice.length) {\n\t\t\t\t\t\t\t\tslice.replaceWith(updatedSlice);\n\t\t\t\t\t\t\t\tsetSliceEdit(updatedSlice.attr(\"id\"), updatedSlice);\n\t\t\t\t\t\t\t\texistingSliceEdit = updatedSlice;\n\t\t\t\t\t\t\t\tif (scrollPosition) {\n\t\t\t\t\t\t\t\t\tconsole.log(\"Restoring scroll position:\", scrollPosition);\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\twindow.scrollTo({\n\t\t\t\t\t\t\t\t\t\t\ttop: scrollPosition,\n\t\t\t\t\t\t\t\t\t\t\tbehavior: \"instant\",\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$(document).trigger(\"rex:ready\", [updatedSlice || slice]);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.error(\"Error updating slice:\", error);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tif (existingSliceEdit.length) {\n\t\t\thandleSave(existingSliceEdit);\n\t\t}\n\n\t\tconst scrollToSlice = (slice) => {\n\t\t\tslice.scrollIntoView({ behavior: \"auto\" });\n\t\t};\n\t\tconst setSliceEdit = (id, element) => {\n\t\t\trex.isSliceEditing = true;\n\t\t\trex.sliceEditCurrent = element.clone(true, true);\n\t\t\trex.sliceEditCurrentId = id;\n\t\t};\n\t\tconst restore = () => {\n\t\t\tif (rex.isSliceEditing && rex.sliceEditCurrent) {\n\t\t\t\tconst currentSlice = $(`#${rex.sliceEditCurrentId}`);\n\t\t\t\tif (currentSlice.length && currentSlice.hasClass(\"rex-slice-edit\")) {\n\t\t\t\t\tcurrentSlice.replaceWith(rex.sliceEditCurrent);\n\t\t\t\t}\n\t\t\t\trex.isSliceEditing = false;\n\t\t\t\trex.sliceEditCurrent = null;\n\t\t\t}\n\t\t};\n\t\tconst debouncedScrollToSlice = debounce(\n\t\t\t(slice) => scrollToSlice(slice),\n\t\t\tDEBOUNCE_DELAY,\n\t\t);\n\t\tconst restoreExistingSlice = async (slice) => {\n\t\t\tconst sliceId = slice.attr(\"id\");\n\t\t\tconst $contentNav = $(\"#rex-js-structure-content-nav\");\n\t\t\tconst editUrl = $contentNav.find('a[href*=\"edit\"]:first').attr(\"href\");\n\t\t\tif (editUrl) {\n\t\t\t\ttry {\n\t\t\t\t\tconst result = await fetch(editUrl, {\n\t\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\"Content-Type\": \"text/html\",\n\t\t\t\t\t\t\t\"X-Requested-With\": \"XMLHttpRequest\",\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tif (!result.ok) throw new Error(\"Network response was not ok\");\n\t\t\t\t\tconst html = await result.text();\n\t\t\t\t\tconst resultSlice = $(html).find(`#${sliceId}`);\n\t\t\t\t\tif (resultSlice.length) {\n\t\t\t\t\t\t$(\".panel-body .alert\").remove();\n\t\t\t\t\t\tsetSliceEdit(sliceId, slice);\n\t\t\t\t\t\tslice.replaceWith(resultSlice);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(\"Error restoring slice:\", error);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t};\n\t\t// handle back/forward navigation\n\t\t$(window)\n\t\t\t.off(\"popstate.asyncEdit\")\n\t\t\t.on(\"popstate.asyncEdit\", () => {\n\t\t\t\t// check current url for slice_id and open edit if found\n\t\t\t\tconst urlParams = new URLSearchParams(window.location.search);\n\t\t\t\tconst sliceId = urlParams.get(\"slice_id\");\n\t\t\t\tif (sliceId) {\n\t\t\t\t\tconst $slice = $(`#slice${sliceId}`);\n\t\t\t\t\tif ($slice.length) {\n\t\t\t\t\t\tsetHistory = false;\n\t\t\t\t\t\t$slice.find(\"a.btn-edit\").trigger(\"click.asyncEdit\");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// no slice_id in url, just scroll to top of page\n\t\t\t\t\twindow.scrollTo({ top: 0, behavior: \"auto\" });\n\t\t\t\t}\n\t\t\t});\n\n\t\thandleEdit();\n\t}\n\n\t$(document).on(\"rex:ready rex:selectMedia rex:YForm_selectData\", () => {\n\t\tiframePreviews();\n\t\tasyncEdit();\n\t});\n})(jQuery);\n"],"names":["$","debounceTimer","debounce","func","delay","args","iframePreviews","$iframes","resizeIframe","event","_a","_b","iframe","wrapper","zoomFactor","asyncEdit","setHistory","existingSliceEdit","handleEdit","e","$this","slice","sliceId","restoreExistingSlice","restore","result","html","resultSlice","setSliceEdit","handleSave","debouncedScrollToSlice","error","form","saveButton","applyButton","buttonAction","buttonActionValue","formData","response","updatedSlice","url","scrollPosition","scrollToSlice","id","element","currentSlice","editUrl","$slice"],"mappings":"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"}