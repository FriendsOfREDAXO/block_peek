{"version":3,"file":"BlockPeekPoster.js","sources":["../assets-src/BlockPeekPoster.js"],"sourcesContent":["(() => {\n\tconst SLICE_ID = BLOCK_PEEK_PLACEHOLDER_SLICE_ID;\n\tconst maxHeight = BLOCK_PEEK_PLACEHOLDER_MAX_HEIGHT || 10000;\n\tconst SLICE_WRAPPER = document.body;\n\n\tlet lastHeight = 0;\n\n\t// Get current SLICE_WRAPPER height\n\tfunction getCurrentHeight() {\n\t\treturn Math.min(\n\t\t\tMath.max(\n\t\t\t\tSLICE_WRAPPER.scrollHeight,\n\t\t\t\tSLICE_WRAPPER.offsetHeight,\n\t\t\t\tSLICE_WRAPPER.clientHeight,\n\t\t\t),\n\t\t\tmaxHeight,\n\t\t);\n\t}\n\n\t// Send height to parent if it has changed\n\tfunction sendHeight() {\n\t\tconst currentHeight = getCurrentHeight();\n\n\t\t// Only send if height has actually changed\n\t\tif (currentHeight !== lastHeight) {\n\t\t\tlastHeight = currentHeight;\n\n\t\t\ttry {\n\t\t\t\tparent.postMessage(\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"resize\",\n\t\t\t\t\t\tid: SLICE_ID,\n\t\t\t\t\t\theight: currentHeight,\n\t\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\t},\n\t\t\t\t\t\"*\",\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.warn(\"Failed to send height to parent:\", error);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Initialize the script\n\tfunction init() {\n\t\t// Clean up any existing listeners/timers\n\t\tcleanup();\n\n\t\tconst exec = () => {\n\t\t\trequestAnimationFrame(() => sendHeight());\n\t\t};\n\n\t\tconst resizeObserver = new window.ResizeObserver(exec);\n\t\texec();\n\t\tresizeObserver.observe(document.body);\n\t\twindow.__resizeObserver = resizeObserver;\n\t}\n\n\t// Cleanup function\n\tfunction cleanup() {\n\t\tif (window?.__resizeObserver) {\n\t\t\twindow?.__resizeObserver.disconnect();\n\t\t\tdelete window?.__resizeObserver;\n\t\t}\n\t}\n\n\t// Handle page unload\n\twindow.addEventListener(\"beforeunload\", cleanup);\n\n\t// Initialize\n\tinit();\n\n\tconst originalReplaceState = history.replaceState;\n\thistory.replaceState = function (...args) {\n\t\ttry {\n\t\t\treturn originalReplaceState.apply(this, args);\n\t\t} catch (_e) {\n\t\t\t// Silently fail in srcdoc context\n\t\t}\n\t};\n})();\n"],"names":["SLICE_ID","maxHeight","SLICE_WRAPPER","lastHeight","getCurrentHeight","sendHeight","currentHeight","error","init","cleanup","exec","resizeObserver","originalReplaceState","args","_e"],"mappings":"CAAC,IAAM,CACN,MAAMA,EAAW,gCACXC,EAAY,mCAAqC,IACjDC,EAAgB,SAAS,KAE/B,IAAIC,EAAa,EAGjB,SAASC,GAAmB,CAC3B,OAAO,KAAK,IACX,KAAK,IACJF,EAAc,aACdA,EAAc,aACdA,EAAc,YAClB,EACGD,CACH,CACC,CAGA,SAASI,GAAa,CACrB,MAAMC,EAAgBF,EAAgB,EAGtC,GAAIE,IAAkBH,EAAY,CACjCA,EAAaG,EAEb,GAAI,CACH,OAAO,YACN,CACC,KAAM,SACN,GAAIN,EACJ,OAAQM,EACR,UAAW,KAAK,IAAG,CACzB,EACK,GACL,CACG,OAASC,EAAO,CACf,QAAQ,KAAK,mCAAoCA,CAAK,CACvD,CACD,CACD,CAGA,SAASC,GAAO,CAEfC,EAAO,EAEP,MAAMC,EAAO,IAAM,CAClB,sBAAsB,IAAML,GAAY,CACzC,EAEMM,EAAiB,IAAI,OAAO,eAAeD,CAAI,EACrDA,EAAI,EACJC,EAAe,QAAQ,SAAS,IAAI,EACpC,OAAO,iBAAmBA,CAC3B,CAGA,SAASF,GAAU,CACd,qBAAQ,mBACX,qBAAQ,iBAAiB,aACzB,4BAAe,iBAEjB,CAGA,OAAO,iBAAiB,eAAgBA,CAAO,EAG/CD,EAAI,EAEJ,MAAMI,EAAuB,QAAQ,aACrC,QAAQ,aAAe,YAAaC,EAAM,CACzC,GAAI,CACH,OAAOD,EAAqB,MAAM,KAAMC,CAAI,CAC7C,OAASC,EAAI,CAEb,CACD,CACD,GAAC"}